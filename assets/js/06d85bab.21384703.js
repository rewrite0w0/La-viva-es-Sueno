"use strict";(self.webpackChunkla_viva_es_sueno=self.webpackChunkla_viva_es_sueno||[]).push([[4614],{3905:function(e,n,r){r.d(n,{Zo:function(){return p},kt:function(){return m}});var t=r(7294);function o(e,n,r){return n in e?Object.defineProperty(e,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[n]=r,e}function s(e,n){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(e);n&&(t=t.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),r.push.apply(r,t)}return r}function a(e){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?s(Object(r),!0).forEach((function(n){o(e,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):s(Object(r)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(r,n))}))}return e}function c(e,n){if(null==e)return{};var r,t,o=function(e,n){if(null==e)return{};var r,t,o={},s=Object.keys(e);for(t=0;t<s.length;t++)r=s[t],n.indexOf(r)>=0||(o[r]=e[r]);return o}(e,n);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);for(t=0;t<s.length;t++)r=s[t],n.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(o[r]=e[r])}return o}var i=t.createContext({}),l=function(e){var n=t.useContext(i),r=n;return e&&(r="function"==typeof e?e(n):a(a({},n),e)),r},p=function(e){var n=l(e.components);return t.createElement(i.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return t.createElement(t.Fragment,{},n)}},u=t.forwardRef((function(e,n){var r=e.components,o=e.mdxType,s=e.originalType,i=e.parentName,p=c(e,["components","mdxType","originalType","parentName"]),u=l(r),m=o,g=u["".concat(i,".").concat(m)]||u[m]||d[m]||s;return r?t.createElement(g,a(a({ref:n},p),{},{components:r})):t.createElement(g,a({ref:n},p))}));function m(e,n){var r=arguments,o=n&&n.mdxType;if("string"==typeof e||o){var s=r.length,a=new Array(s);a[0]=u;var c={};for(var i in n)hasOwnProperty.call(n,i)&&(c[i]=n[i]);c.originalType=e,c.mdxType="string"==typeof e?e:o,a[1]=c;for(var l=2;l<s;l++)a[l]=r[l];return t.createElement.apply(null,a)}return t.createElement.apply(null,r)}u.displayName="MDXCreateElement"},1435:function(e,n,r){r.r(n),r.d(n,{assets:function(){return p},contentTitle:function(){return i},default:function(){return m},frontMatter:function(){return c},metadata:function(){return l},toc:function(){return d}});var t=r(7462),o=r(3366),s=(r(7294),r(3905)),a=["components"],c={slug:"understand-sakura-api",title:"SAKURA API \uc774\ud574\ud558\uae30",authors:"rewrite0w0",tags:["\ucf54\ub4dc\uad6c\uacbd","\uac10\uc0c1"]},i=void 0,l={permalink:"/La-viva-es-Sueno/blog/understand-sakura-api",source:"@site/blog/article-list/2022-04-13-understand-sakura-api.md",title:"SAKURA API \uc774\ud574\ud558\uae30",description:"public apis\uc5d0\uc11c \ub9c8\uc74c\uc5d0 \ub4dc\ub294 api\uac00 \uc788\uc73c\ub2c8 \uc774\ud574\ud558\uae30 \uc704\ud55c \uc2dc\ub3c4.",date:"2022-04-13T00:00:00.000Z",formattedDate:"April 13, 2022",tags:[{label:"\ucf54\ub4dc\uad6c\uacbd",permalink:"/La-viva-es-Sueno/blog/tags/\ucf54\ub4dc\uad6c\uacbd"},{label:"\uac10\uc0c1",permalink:"/La-viva-es-Sueno/blog/tags/\uac10\uc0c1"}],readingTime:5.535,truncated:!1,authors:[{name:"rewrite0w0",title:"JavaScript \uac1c\ubc1c\uc790",url:"https://github.com/rewrite0w0",key:"rewrite0w0"}],frontMatter:{slug:"understand-sakura-api",title:"SAKURA API \uc774\ud574\ud558\uae30",authors:"rewrite0w0",tags:["\ucf54\ub4dc\uad6c\uacbd","\uac10\uc0c1"]},prevItem:{title:"\uc544\ud0a4\ud14d\ucc98\uc640 \ub514\uc790\uc778",permalink:"/La-viva-es-Sueno/blog/difference-architecture-and-design"},nextItem:{title:"\ub77c\uc774\ube0c\ub7ec\ub9ac \ub9cc\ub4dc\ub294 \uacfc\uc815 \uae30\ub85d",permalink:"/La-viva-es-Sueno/blog/first-js-lib"}},p={authorsImageUrls:[void 0]},d=[{value:"package.json",id:"packagejson",level:2},{value:"index.js",id:"indexjs",level:2},{value:"connectDB",id:"connectdb",level:2},{value:"/api/card",id:"apicard",level:2},{value:"cardController",id:"cardcontroller",level:2},{value:"cardModel",id:"cardmodel",level:2},{value:"\uac10\uc0c1",id:"\uac10\uc0c1",level:2}],u={toc:d};function m(e){var n=e.components,r=(0,o.Z)(e,a);return(0,s.kt)("wrapper",(0,t.Z)({},u,r,{components:n,mdxType:"MDXLayout"}),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://github.com/public-apis/public-apis"},"public apis"),"\uc5d0\uc11c \ub9c8\uc74c\uc5d0 \ub4dc\ub294 ",(0,s.kt)("a",{parentName:"p",href:"https://github.com/JessVel/sakura-card-captor-api"},"api"),"\uac00 \uc788\uc73c\ub2c8 \uc774\ud574\ud558\uae30 \uc704\ud55c \uc2dc\ub3c4."),(0,s.kt)("p",null,(0,s.kt)("strong",{parentName:"p"},"realize!")),(0,s.kt)("h2",{id:"packagejson"},"package.json"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-json"},'{\n  "main": "src/index.js",\n  "scripts": {\n    "start": "node src/index.js",\n    "dev": "nodemon --watch src src/index.js"\n  },\n  "dependencies": {\n    "cors": "^2.8.5",\n    "dotenv": "^8.2.0",\n    "express": "^4.17.1",\n    "mongoose": "^5.11.18"\n  },\n  "devDependencies": {\n    "consola": "^2.15.3",\n    "nodemon": "^2.0.7"\n  }\n}\n')),(0,s.kt)("p",null,(0,s.kt)("inlineCode",{parentName:"p"},"index.js"),"\uac00 \uc2dc\uc791\uc810, \uc704\uc640 \uac19\uc740 \ud328\ud0a4\uc9c0\ub97c \uc758\uc874\ud558\uace0 \uc788\ub2e4."),(0,s.kt)("p",null,(0,s.kt)("a",{parentName:"p",href:"https://www.npmjs.com/package/consola"},(0,s.kt)("inlineCode",{parentName:"a"},"consola")),"\uc740 \ucd08\uba74\uc778\ub370, ",(0,s.kt)("inlineCode",{parentName:"p"},"Elegant Console Logger for Node.js and Browser")," \uc774\ub77c \ud55c\ub2e4. \uac1c\ubc1c\ud560 \ub54c \uae30\ubd84 \uc88b\uac8c\ud558\ub294 \uc6a9\ub3c4\ub85c \uc774\ud574\ud558\uc790."),(0,s.kt)("h2",{id:"indexjs"},"index.js"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"const express = require('express');\nconst cors = require('cors');\n\nconst connectDB = require('./config/db');\nrequire('dotenv').config();\nconnectDB();\n\nconst app = express();\nconst PORT = process.env.PORT || 4000;\n\napp.use(\n  cors({\n    origin: '*',\n    optionsSuccessStatus: 200,\n    credentials: true,\n    // cors \uc635\uc158\n  })\n);\n// callback \ud568\uc218(\ubbf8\ub4e4\uc6e8\uc5b4) cors \uc7a5\ucc29\n// Access-Control-Allow-Credentials \ud5c8\uc6a9\n// https://developer.mozilla.org/ko/docs/Web/HTTP/Headers/Access-Control-Allow-Credentials\n\napp.options('*', cors());\n\n// Pre-Flight cors \ucf1c\uae30\n// https://expressjs.com/en/resources/middleware/cors.html\n\napp.use(express.json({ extended: true }));\n\n// express.json\ub294 \ubbf8\ub4e4\uc6e8\uc5b4\n// body-parse \uae30\ubc18 JSON \ud398\uc774\ub85c\ub4dc \ub9ac\ud018\uc2a4\ud2b8\n// https://expressjs.com/en/4x/api.html#express.json\n\n// extended: true\n// bodyParser.urlencoded([options]) \uc635\uc158\uc744 true\ub85c\n// express.json({ extended: true })\uc774 \uc6a9\ub840\ub294 \ubabb\ucc3e\uaca0\uc74c\n// express.json()\uc73c\ub85c\ub3c4 \ub3cc\uc544\uac00\ub294\ub4ef?\n// express.urlencoded({ extended: true }) \uc774\uac83\uc744 \uc758\ub3c4\ud55c\ub4ef\n// https://expressjs.com/en/resources/middleware/body-parser.html\n\n// \ucd94\uac00\n// https://stackoverflow.com/questions/57762864/meaning-of-argument-in-express-json-extended-false\n// \uae00\uc744 \ubcf4\uba74 extended\ub97c \uc0ac\uc6a9\ud560 \ud544\uc694\uac00 \uc5c6\ub2e4\ub294 \uac19\uc740 \uc758\uacac\n\napp.use(function (req, res, next) {\n  res.header('Access-Control-Allow-Origin', '*');\n  // \uc751\ub2f5\uc774 \uc8fc\uc5b4\uc9c4 origin\uc73c\ub85c\ubd80\ud130 \uc694\uccad \ucf54\ub4dc\uc640 \uacf5\uc720\ub420 \uc218 \uc788\ub294\uac00 \uc5ec\ubd80\n\n  res.header('Access-Control-Allow-Credentials', true);\n  // \uc694\uccad \uc790\uaca9 \uc99d\uba85\ubaa8\ub4dc, true\uba74 \ud504\ub860\ud2b8\uc5d4\ub4dc \uc790\ubc14\uc2a4\ud06c\ub9bd\ud2b8\uc5d0 \ub178\ucd9c\uc744 \ube0c\ub77c\uc6b0\uc800\uc5d0\uc11c \uac00\ub2a5\n\n  res.header('Access-Control-Allow-Methods', 'GET,PUT,POST,DELETE,OPTIONS');\n  // Preflight reqeust, \ub9ac\uc18c\uc2a4\uc5d0 \uc811\uadfc\ud560 \uc218 \uc788\uc744 \ub54c \uc774\uc6a9 \uac00\ub2a5\ud55c \ud558\ub098 \uc774\uc0c1\uc758 \uba54\uc18c\ub4dc \uc9c0\uc815\n\n  res.header(\n    'Access-Control-Allow-Headers',\n    'Content-Type, Authorization, Content-Length, X-Requested-With, Accept'\n  );\n  // Access-Control-Allow-Headers\n  // Access-Control-Request-Headers\uc744 \ud3ec\ud568\ud558\ub294 preflight request, \ub9ac\ud018\uc2a4\ud2b8 \uac04 \uc0ac\uc6a9\ud558\ub294 HTTP \ud5e4\ub354\ub97c \uac8c\uc2dc\ud558\uae30 \uc704\ud574 \uc0ac\uc6a9\n\n  // Content-Type\n  // \ub9ac\uc18c\uc2a4 \ubbf8\ub514\uc5b4 \ud0c0\uc785\uc744 \ub098\ud0c0\ub0b4\uae30 \uc704\ud574 \uc0ac\uc6a9\n\n  // Authorization\n  // \uc0ac\uc6a9\uc790 \uc5d0\uc774\uc804\ud2b8\ub97c \uc11c\ubc84\uc5d0\uc11c \uc778\uc99d, \ubcf4\ud638\ub41c \ub9ac\uc18c\uc2a4\uc5d0 \uc811\uadfc \uac00\ub2a5\ud558\ub3c4\ub85d \uc778\uc99d\uc815\ubcf4 \uc81c\uacf5\ud558\uae30 \uc704\ud568\n\n  // Content-Length\n  // \uc218\uc2e0\uc790\uc5d0\uac8c \ubcf4\ub0b4\uc9c0\ub294 \ubc14\uc774\ud2b8 \ub2e8\uc704\uc758 \uac1c\uccb4(\uc5d4\ud2f0\ud2f0) \ubcf8\ubb38 \ud06c\uae30\n\n  // X-Requested-With\n  // MDN\uc5d0 \uc5c6\uc74c\n  // \uc0ac\ub77c\uc84c\uac70\ub098 \ub2e4\ub978 \ud504\ub808\uc784\uc6cc\ud06c\uc5d0\uc11c \uc4f0\ub358 \ud5e4\ub354\uc778\ub4ef?\n  // \uc77c\ub2e8 XMLHttpRequest \uc18c\uc18d\n  // https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers\n  // https://www.checkheaders.com/headers/X-Requested-With/\n  // https://stackoverflow.com/questions/17478731/whats-the-point-of-the-x-requested-with-header\n  // https://github.com/mdn/content/issues/1506\n\n  // res.header\ub294 res.set\ub791 alias\n  // https://expressjs.com/en/api.html#res.set\n\n  next();\n  // next()\ub294 \uc5ec\uae30\uc5d0 \ube44\ub86f\n  // router.use(path, function mounted_app(req, res, next) {\n  //   var orig = req.app;\n  //   fn.handle(req, res, function (err) {\n  //     setPrototypeOf(req, orig.request);\n  //     setPrototypeOf(res, orig.response);\n  //     next(err);\n  //   });\n  // });\n  // https://github.com/expressjs/express/blob/947b6b7d57939d1a3b33ce008765f9aba3eb6f70/lib/application.js#L228\n});\n\n// api \uacbd\ub85c, \ubbf8\ub4e4\uc6e8\uc5b4\napp.use('/api/card', require('./routes/card_routes'));\n\n// \uc11c\ubc84 \ub3cc\ub9ac\uae30\napp.listen(PORT, () => {\n  console.log(`Server running in ${PORT}`);\n});\n")),(0,s.kt)("h2",{id:"connectdb"},"connectDB"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"// config/db.js\n\n// \uc784\ud3ec\ud2b8\nconst mongoose = require('mongoose');\nrequire('dotenv').config();\n\n// DB \uc5f0\uacb0\nconst connectDB = async () => {\n  try {\n    await mongoose.connect(process.env.DB_MONGO, {\n      useNewUrlParser: true,\n      useUnifiedTopology: true,\n      useCreateIndex: true,\n      useFindAndModify: false,\n      // 6.x \ubc84\uc804\ubd80\ud130\ub294 \uc0ac\uc6a9\ub418\uc9c0 \uc54a\uc74c, \uc774 \ud504\ub85c\uc81d\ud2b8\ub294 5.x\ubc84\uc804\n      // 6.x \uc5d0\uc11c\ub294 \uc704\uc640 \uac19\uc740 \uc124\uc815\uc774 \uae30\ubcf8\uac12\n      // https://mongoosejs.com/docs/5.x/docs/api/mongoose.html#mongoose_Mongoose-connect\n      // https://mongoosejs.com/docs/migrating_to_6.html#no-more-deprecation-warning-options\n    });\n    console.log('Data base connected');\n  } catch (err) {\n    console.log(`Error: ${err.message}`);\n    process.exit(1);\n  }\n};\n\nmodule.exports = connectDB;\n")),(0,s.kt)("h2",{id:"apicard"},"/api/card"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"// src/routes/card_routes.js\n\nconst express = require('express');\nconst router = express.Router();\nconst cardController = require('../controller/card_controller');\n\nrouter.get('/', cardController.getCards);\n\nrouter.get('/:id', cardController.getCard);\n\nrouter.post('/', cardController.createCard);\n\n// router \uba54\uc11c\ub4dc \ub4f1\ub85d\n// https://expressjs.com/en/4x/api.html#router.METHOD\n\nmodule.exports = router;\n")),(0,s.kt)("h2",{id:"cardcontroller"},"cardController"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"// src/controller/card_controller.js\n\nconst cardModel = require('../models/card');\n\nexports.getCards = async (req, res) => {\n  try {\n    const DEFAULT_PAGE = 1,\n      DEFAULT_PAGE_SIZE = 60;\n\n    let { page = DEFAULT_PAGE, pageSize = DEFAULT_PAGE_SIZE } = req.query;\n\n    // query \ud30c\uc11c\n    // https://expressjs.com/en/api.html#app.settings.table\n\n    page = +page;\n    pageSize = +pageSize;\n\n    if (!page || !pageSize) throw new Error('Invalid page or pageSize format');\n\n    const cards = await cardModel.find();\n    // https://mongoosejs.com/docs/api.html#model_Model.find\n\n    pageSize = pageSize > DEFAULT_PAGE_SIZE ? DEFAULT_PAGE_SIZE : pageSize;\n\n    const start = (page - 1) * pageSize;\n    const end =\n      start + pageSize > cards.length ? cards.length : start + pageSize;\n\n    const data = cards.slice(start, end);\n\n    // json.stringify()\n    res.json({\n      data: data,\n      page: page,\n      pageSize: pageSize,\n      count: data.length,\n      totalCount: cards.length,\n    });\n\n    console.log(cards);\n  } catch (error) {\n    console.log(error);\n    res.status(400).json({ msg: 'Hubo un error' });\n  }\n};\n\nexports.getCard = async (req, res) => {\n  try {\n    {\n      const card = await cardModel.findById(req.params.id);\n\n      // https://mongoosejs.com/docs/api.html#model_Model.findById\n      // http://expressjs.com/en/api.html#req.params\n\n      res.json(card);\n      console.log(card);\n    }\n  } catch (error) {\n    console.log(error);\n    res.status(400).json({ msg: 'Hubo un error' });\n  }\n};\n\nexports.createCard = async (req, res) => {\n  try {\n    const card = new cardModel(req.body);\n    card.save();\n    // https://mongoosejs.com/docs/api.html#model_Model-save\n    res.json({ card });\n  } catch (error) {\n    console.log(error);\n    res.status(400).json({ msg: 'Hubo un error' });\n  }\n};\n\nexports.editCard = async (req, res) => {\n  try {\n  } catch (error) {\n    console.log(error);\n    res.status(400).json({ msg: 'Hubo un error' });\n  }\n};\n")),(0,s.kt)("h2",{id:"cardmodel"},"cardModel"),(0,s.kt)("pre",null,(0,s.kt)("code",{parentName:"pre",className:"language-js"},"// src/models/card.js\n\nconst mongoose = require('mongoose');\n\n// https://mongoosejs.com/docs/api/schema.html#schema_Schema\n//\n\nconst CardSchema = mongoose.Schema({\n  cardNumber: {\n    type: Number,\n    require: true,\n    trim: true,\n  },\n  spanishName: {\n    type: String,\n    require: true,\n    trim: true,\n  },\n  englishName: {\n    type: String,\n    require: true,\n    trim: true,\n  },\n  kanji: {\n    type: String,\n    trim: true,\n  },\n  R\u014dmaji: {\n    type: String,\n    trim: true,\n  },\n  appeardManga: {\n    type: String,\n    trim: true,\n  },\n  appeardAnime: {\n    type: String,\n    trim: true,\n  },\n  clowCard: {\n    type: String,\n    trim: true,\n    require: true,\n  },\n  sakuraCard: {\n    type: String,\n    trim: true,\n    require: true,\n  },\n});\n\nmodule.exports = mongoose.model('Card', CardSchema);\n// `Card`\ub85c `CardSchema` \ub0b4\ubcf4\ub0b4\uae30\n// \uac19\uc774\ubcf4\uae30\n// https://javascript.tutorialink.com/how-to-exports-many-mongoose-models-modules-in-node-js/\n")),(0,s.kt)("h2",{id:"\uac10\uc0c1"},"\uac10\uc0c1"),(0,s.kt)("ul",null,(0,s.kt)("li",{parentName:"ul"},"cors\uc5d0 \uc2e0\uacbd\uc744 \uad49\uc7a5\ud788 \ub9ce\uc774 \uc368\uc57c\ud55c\ub2e4. \uc815\ub9d0 \ub9ce\uc740 \ubd80\ubd84\uc774 \uc18c\ube44\ub41c\ub2e4."),(0,s.kt)("li",{parentName:"ul"},"\uc624\ub798\ub41c \ud504\ub85c\uc81d\ud2b8\ub77c \uc774\uc81c\ub294 \uc4f0\uc9c0 \uc54a\ub294 \uae30\ub2a5\ub3c4 \uc788\ub2e4.")))}m.isMDXComponent=!0}}]);